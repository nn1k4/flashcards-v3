# üìñ Flashcards-v3 ‚Äî Glossary (v5.x)

> –≠—Ç–æ—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç **—Ç–µ—Ä–º–∏–Ω—ã –∏ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏**, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ `flashcards-v3`.  
> –¶–µ–ª—å: —á—Ç–æ–±—ã –ª—é–±–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏–ª–∏ –∞–≥–µ–Ω—Ç (Codex/ChatGPT) —á–∏—Ç–∞–ª TRS/–ø–ª–∞–Ω—ã/–∫–æ–¥ –∏ **–Ω–µ –ø—É—Ç–∞–ª—Å—è** –≤
> –∑–Ω–∞—á–µ–Ω–∏—è—Ö.

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã

- **Manifest-first** ‚Äî –ø–æ—Ä—è–¥–æ–∫ –∏ —Å–æ—Å—Ç–∞–≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π (Latvian LV) –≤—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è **–º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–º**;
  –Ω–∏–∫–∞–∫–æ–π –¥—Ä—É–≥–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞.
- **SID-aggregation** ‚Äî –∞–≥—Ä–µ–≥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–¥—ë—Ç –ø–æ `SID` (sentence id), –∞ –Ω–µ –ø–æ –ø–æ—Ä—è–¥–∫—É —Å—Ç—Ä–æ–∫ –≤
  JSONL –∏–ª–∏ –ø—Ä–∏—Ö–æ–¥—É –æ—Ç–≤–µ—Ç–æ–≤.
- **JSON-only via tools** ‚Äî Claude/LLM –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON —á–µ—Ä–µ–∑ **–Ω–∞—à tool**
  (`emit_flashcards`), –ø–∞—Ä—Å–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã.
- **Config-first** ‚Äî –Ω–∏–∫–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Ç–∞–π–º–∏–Ω–≥–∏, –ª–∏–º–∏—Ç—ã, —Ö–æ—Ç–∫–µ–∏, –º–æ–¥–µ–ª–∏, —Å—Ç–∏–ª–∏) –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥—è—Ç—Å—è; –≤—Å—ë
  –∏–∑ `/config/*.json` c –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π Zod.
- **FSM-first** ‚Äî –ø—Ä–æ—Ü–µ—Å—Å—ã —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–æ–Ω–µ—á–Ω—ã–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏; UI ‚Äî —ç—Ç–æ **–ø—Ä–æ–µ–∫—Ü–∏—è FSM**.
- **Immediate errors** ‚Äî –ª—é–±–∞—è –æ—à–∏–±–∫–∞ (429, 413, 500, 529, network, expired, max_tokens) –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
  –≤ –±–∞–Ω–Ω–µ—Ä.

---

## –ë–∞–∑–æ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

- **Manifest (–º–∞–Ω–∏—Ñ–µ—Å—Ç)** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç LV-—Ç–µ–∫—Å—Ç –∫–∞–∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
  –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π. –ö–∞–∂–¥–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–º–µ–µ—Ç:
  - `sid` (sentence id) ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –≤ —Ä–∞–º–∫–∞—Ö –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞.
  - `lv` ‚Äî –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –ª–∞—Ç—ã—à—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.
- **SID** ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∫–ª—é—á –ø—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, —ç–∫—Å–ø–æ—Ä—Ç–µ, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏.
- **DTO** ‚Äî Data Transfer Object. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (Zod-—Å—Ö–µ–º–∞), –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è —Ñ–æ—Ä–º–∞—Ç –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ (API
  ‚Üî UI).
- **Zod** ‚Äî TypeScript-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ö–µ–º. –í—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ Zod.
- **FSM (Finite State Machine)** ‚Äî –∫–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, batch
  polling).
- **Pipeline (–ø–∞–π–ø–ª–∞–π–Ω)** ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏: –≤–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ ‚Üí split ‚Üí manifest ‚Üí
  batch/tool-use ‚Üí –∞–≥—Ä–µ–≥–∞—Ü–∏—è ‚Üí UI.
- **Retry (—Ä–µ—Ç—Ä–∞–π)** ‚Äî –ø–æ–≤—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (max_tokens, 429/Retry-After, network).
  –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff + jitter.
- **Polling (–ø–æ–ª–ª–∏–Ω–≥)** ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ batch –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.
- **Prompt caching** ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `system`+`tools` –±–ª–æ–∫–æ–≤ –¥–ª—è —É–¥–µ—à–µ–≤–ª–µ–Ω–∏—è LLM-–≤—ã–∑–æ–≤–æ–≤. –°–º–µ–Ω–∞
  `tool_choice` –º–æ–∂–µ—Ç –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à.
- **Tool-use** ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º Claude –¥–ª—è JSON-only –≤—ã–≤–æ–¥–∞. –í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–æ–¥–∏–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π
  tool** `emit_flashcards`.

---

## –û—à–∏–±–∫–∏ –∏ stop reasons

- **Stop reason** ‚Äî –ø—Ä–∏—á–∏–Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (`end_turn`, `tool_use`, `max_tokens`).
- **max_tokens**:
  - –ï—Å–ª–∏ single-–≤—ã–∑–æ–≤: —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ª–∏–º–∏—Ç –∏ —Ä–µ—Ç—Ä–∞–∏–º.
  - –ï—Å–ª–∏ batch-–≤—ã–∑–æ–≤: —Å–ø–ª–∏—Ç–∏–º –ø—Ä–æ–±–ª–µ–º–Ω—ã–π —á–∞–Ω–∫ –∏ —Ä–µ—Ç—Ä–∞–∏–º –µ–≥–æ –æ—Ç–¥–µ–ª—å–Ω–æ.
  - –ß–∞—Å—Ç–∏—á–Ω—ã–π —É—Å–ø–µ—Ö –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç —Ç–æ, —á—Ç–æ –≥–æ—Ç–æ–≤–æ.
- **DoD (Definition of Done) —Ä–∏—Å–∫–∏** ‚Äî –µ—Å–ª–∏ –Ω–∞—Ä—É—à–µ–Ω—ã –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—à–ª–∏ –Ω–µ
  JSON-only, –ø–æ—Ç–µ—Ä—è–Ω –ø–æ—Ä—è–¥–æ–∫ SID, –æ—à–∏–±–∫–∏ –Ω–µ –ø–æ–∫–∞–∑–∞–Ω—ã —Å—Ä–∞–∑—É) ‚Äî –∑–∞–¥–∞—á–∞ **–Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π**.
- **Expired batch** ‚Äî –±–∞—Ç—á–∏ —Å—Ç–∞—Ä—à–µ 29 –¥–Ω–µ–π —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏, UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–Ω–Ω–µ—Ä –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç
  ¬´Get results¬ª.

---

## Stores –∏ —Ö—É–∫–∏

- **Stores** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `CardStore`, `ContextStore`, `UiStore`.
- **Hooks** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ React (`useBatch`, `useProcessing`, `useLLMToolsEmitter`).
- **useBatch** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π: create ‚Üí poll ‚Üí fetch ‚Üí aggregate.
- **useProcessing** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω: —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è ‚Üí —á–∞–Ω–∫–∏ ‚Üí –≤—ã–∑–æ–≤—ã Claude ‚Üí –∞–≥—Ä–µ–≥–∞—Ü–∏—è.
- **useLLMToolsEmitter** ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ LLM-–≤—ã–∑–æ–≤–æ–º —Å tools. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `ok/data/stopReason/error`.
- **useErrorBanners** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –¥–∏—Å–ø–µ—Ç—á–µ—Ä UI-–æ—à–∏–±–æ–∫.

---

## –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä

- **Aggregator** ‚Äî —Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–±–∏—Ä–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ `SID`, —Å—Ç—Ä–æ–∏—Ç RU-—Ç–µ–∫—Å—Ç –∏ –∫–∞—Ä—Ç–æ—á–∫–∏.
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å—Ç—Ä–æ–≥–æ –ø–æ –º–∞–Ω–∏—Ñ–µ—Å—Ç—É.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω—ã–µ —É—Å–ø–µ—Ö–∏ –∏ –¥–æ–≥—Ä—É–∑–∫—É –ø–æ—Å–ª–µ retry.

---

## –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç

- **JSON** ‚Äî –ø–æ–ª–Ω—ã–π —Å–Ω–∞–ø—à–æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∫–∞—Ä—Ç–æ—á–∫–∏, –≤–∏–¥–∏–º–æ—Å—Ç—å, –ø–µ—Ä–µ–≤–æ–¥—ã).
- **JSONL** ‚Äî —Ñ–æ—Ä–º–∞—Ç –±–∞—Ç—á–µ–π (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = `custom_id==SID`). –ü–æ—Ä—è–¥–æ–∫ —Å—Ç—Ä–æ–∫ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.
- **Export CSV/TSV** ‚Äî –¥–ª—è Anki/Quizlet (v1.3).

---

## –ú–∏–Ω–∏-–¥–∏–∞–≥—Ä–∞–º–º—ã

### FSM (Batch)

```mermaid
stateDiagram-v2
  [*] --> idle
  idle --> submitted: SUBMIT
  submitted --> in_progress: TICK
  in_progress --> ready: RESOLVE
  in_progress --> failed: REJECT
  failed --> submitted: RETRY
```

### Tool-use —Ü–∏–∫–ª (emit_flashcards)

```mermaid
sequenceDiagram
  User->>UI: –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞
  UI->>Hook: useProcessing()
  Hook->>Claude: tool-use (emit_flashcards)
  Claude->>Hook: tool_use.input (JSON)
  Hook->>Utils: Zod.parse()
  Utils->>Aggregator: aggregateBySid
  Aggregator->>Store: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏/–ø–µ—Ä–µ–≤–æ–¥
  Store->>UI: render Flashcards/Reading
  Note over Hook,UI: stop_reason=max_tokens ‚Üí –±–∞–Ω–Ω–µ—Ä + retry
```

---

## TL;DR

- Manifest/SID ‚Äî –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.
- Zod/DTO ‚Äî —Å—Ç—Ä–æ–≥–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã.
- FSM ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã.
- emit_flashcards ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π tool (JSON-only).
- Stop reasons ‚Äî max_tokens —Ç—Ä–µ–±—É–µ—Ç split/retry.
- Prompt caching ‚Äî —É–¥–µ—à–µ–≤–ª–µ–Ω–∏–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å.
- Aggregator ‚Äî —Å–∫–ª–µ–∏–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ SID.
- DoD —Ä–∏—Å–∫–∏ ‚Äî –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ = –æ—Ç–∫–∞–∑.
